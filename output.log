-- What is the average annual change of rate of exchanges and the U.S. international trade?

-- excute query:
select t1.year as last_year,t1.import_total as latst_import,t2.year as this_year,t2.import_total as this_import,(t2.import_total+0.0-t1.import_total+0.0)/t1.import_total as increase_rate from
(
   (
       select year,import_total from trading
   )t1 left join
   (
       select year,import_total from trading
   )t2 on t2.year=t1.year+1
);

-- query result:
"last_year"|"latst_import"|"this_year"|"this_import"|"increase_rate"
1960|22432|1961|22208|-0.00998573466476462197
1961|22208|1962|24352|0.09654178674351585014
1962|24352|1963|25410|0.04344612352168199737
1963|25410|1964|27319|0.07512790240062967336
1964|27319|1965|30621|0.12086826018521907830
1965|30621|1966|35987|0.17523921491786682342
1966|35987|1967|38729|0.07619418123211159585
1967|38729|1968|45293|0.16948539853856283405
1968|45293|1969|49129|0.08469299891815512331
1969|49129|1970|54386|0.10700400985161513566
1970|54386|1971|60979|0.12122605082190269555
1971|60979|1972|72665|0.19163974483018744158
1972|72665|1973|89342|0.22950526388219913301
1973|89342|1974|125190|0.40124465536925522151
1974|125190|1975|120181|-0.04001118300183720744
1975|120181|1976|148798|0.23811584193840956557
1976|148798|1977|179547|0.20664928292046936115
1977|179547|1978|208191|0.15953482932045648215
1978|208191|1979|248696|0.19455692128862438818
1979|248696|1980|291241|0.17107231318557596423
1980|291241|1981|310570|0.06636771608393049056
1981|310570|1982|299391|-0.03599510577325562675
1982|299391|1983|323874|0.08177600529074020261
1983|323874|1984|400166|0.23556074275798613041
1984|400166|1985|410950|0.02694881624125987715
1985|410950|1986|448572|0.09154885022508821024
1986|448572|1987|500552|0.11587883327537162373
1987|500552|1988|545715|0.09022639006536783391
1988|545715|1989|580144|0.06308970799776440083
1989|580144|1990|616097|0.06197254474751096280
1990|616097|1991|609479|-0.01074181500640321248
1991|609479|1992|656094|0.07648335709679906937
1992|656094|1993|713174|0.08699972869741226105
1993|713174|1994|801747|0.12419549787288936501
1994|801747|1995|890771|0.11103752181174360490
1995|890771|1996|955667|0.07285374130949480843
1996|955667|1997|1042726|0.09109763128788584308
1997|1042726|1998|1099314|0.05426929030253393509
1998|1099314|1999|1228485|0.11750146000141906680
1999|1228485|2000|1447837|0.17855488671005343981
2000|1447837|2001|1367165|-0.05571897941550050178
2001|1367165|2002|1397660|0.02230528136691620982
2002|1397660|2003|1514308|0.08345949658715281256
2003|1514308|2004|1771433|0.16979702940220879768
2004|1771433|2005|2000267|0.12918016092056544052
2005|2000267|2006|2219358|0.10953087762783668380
2006|2219358|2007|2358922|0.06288485228611156920
2007|2358922|2008|2550339|0.08114596413107343100
2008|2550339|2009|1966827|-0.22879781864293335121
2009|1966827|2010|2348263|0.19393469786615701330
2010|2348263|2011|2675646|0.13941496331543783639
2011|2675646|2012|2755762|0.02994267552583562997
2012|2755762|2013|2758331|0.00093222854513561040
2013|2758331|2014|2851529|0.03378782314377788598
2014|2851529|||

-- When is the peak and valley of the U.S. international trade?

-- excute query:
SELECT * FROM trading where (import_total in (select max(import_total) from trading));

-- query result:
"sampleid"|"year"|"import_total"|"export_total"|"balance_total"|"import_service"|"import_goods"|"export_service"|"export_goods"
108|2014|2851529|2343205|-508324|477428|2374101|710565|1632639

-- excute query:
SELECT * FROM trading where (import_total in (select min(import_total) from trading));

-- query result:
"sampleid"|"year"|"import_total"|"export_total"|"balance_total"|"import_service"|"import_goods"|"export_service"|"export_goods"
55|1961|22208|26403|4195|7671|14537|6295|20108

-- What is the largest type of business for each year(employment-size)?

-- excute query:
SELECT a.year, a.naics_code, b.information
from labors_pattern a, industry b
where paid_employees= (
	select max(paid_employees)
	from labors_pattern
	where (
		year=a.year
		and
		naics_code>0
	)
)
and b.nacis_code = a.naics_code
order by a.year

-- query result:
"year"|"naics_code"|"information"
1998|31|"Manufacturing "
1999|31|"Manufacturing "
2000|31|"Manufacturing "
2001|31|"Manufacturing "
2002|62|"Health Care and Social Assistance "
2003|62|"Health Care and Social Assistance "
2004|62|"Health Care and Social Assistance "
2005|62|"Health Care and Social Assistance "
2006|62|"Health Care and Social Assistance "
2007|62|"Health Care and Social Assistance "
2008|62|"Health Care and Social Assistance "
2009|62|"Health Care and Social Assistance "
2010|62|"Health Care and Social Assistance "
2011|62|"Health Care and Social Assistance "
2012|62|"Health Care and Social Assistance "
2013|62|"Health Care and Social Assistance "

-- When is the peak of the naturalized petitions and when is that of denied petitions?

-- excute query:
SELECT * FROM immigration where (naturalized_total in (select max(naturalized_total) from immigration));

-- query result:
"petitions"|"naturalized_total"|"naturalized_civilian"|"naturalized_military"|"naturalized_np"|"denied"|"year"
525786|1046539|1032281|4342|9916|121283|2008

-- excute query:
SELECT * FROM immigration where (denied in (select max(denied) from immigration));

-- query result:
"petitions"|"naturalized_total"|"naturalized_civilian"|"naturalized_military"|"naturalized_np"|"denied"|"year"
460916|886026|812579|836|72611|399670|2000

-- Which currency in the top-7 reserve currency has most significant change from 2001 to now?

-- excute query:
select stddev(JPY) as JPY_Variance,stddev(EUR) as EUR_Varianve, stddev(GBP) as GBP_Variance,stddev(CAD) as CAD_Variance,stddev(AUD) as AUD_Variance, stddev(RMB) as RMB_Variance from exchange where year>2001;

-- query result:
"jpy_variance"|"eur_varianve"|"gbp_variance"|"cad_variance"|"aud_variance"|"rmb_variance"
14.6355534337905|0.0972581592411368|14.6355534337905|0.17205513483064|0.243787704001731|0.870564145704144
